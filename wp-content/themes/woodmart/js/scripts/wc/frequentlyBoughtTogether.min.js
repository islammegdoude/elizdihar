!function(s){woodmartThemeModule.frequentlyBoughtTogether=function(){function r(o){var n={};return o.find(".wd-fbt-product").each(function(){var t=s(this),d=s(this).find("input"),e=t.data("id"),a=o.parents(".wd-fbt");d.length?d.is(":checked")?(t.find(".wd-fbt-product-variation").length?n[e]=t.find(".wd-fbt-product-variation select").val():n[e]="",a.find(".product.post-"+e).removeClass("wd-disabled-fbt")):d.parents(".wd-fbt-form").hasClass("wd-checkbox-uncheck")||a.find(".product.post-"+e).addClass("wd-disabled-fbt"):t.find(".wd-fbt-product-variation").length?n[e]=t.find(".wd-fbt-product-variation select").val():n[e]=""}),n}s("form.wd-fbt-form").each(function(){var n="",i=s(this);i.on("change",".wd-fbt-product input, .wd-fbt-product select",function(){var t=s(this),o=r(i),d=i.find("input[name=wd-fbt-main-product]").val(),e=i.find(".wd-fbt-purchase-btn");o&&void 0!==o[d]&&(Object.keys(o).length<2?e.addClass("wd-disabled"):e.removeClass("wd-disabled"),d=i.parents(".wd-fbt").find(".wd-carousel"),e=t.parents(".wd-fbt-product").index(),s(d.find(".wd-carousel-item")[e]).hasClass("wd-active")||(1===e&&void 0!==d[0].swiper&&1<d[0].swiper.slides.length&&(e=0),d[0].swiper.slideTo(e,500)),clearTimeout(n),n=setTimeout(function(){var t,d,e,a;d=o,e=(t=i).find("input[name=wd-fbt-main-product]").val(),a=t.find("input[name=wd-fbt-bundle-id]").val(),t.find(".wd-loader-overlay").addClass("wd-loading"),s.ajax({url:woodmart_settings.ajaxurl,data:{action:"woodmart_update_frequently_bought_price",products_id:d,main_product:e,bundle_id:a},method:"POST",success:function(t){t.fragments&&s.each(t.fragments,function(t,d){s(t).replaceWith(d)})},error:function(){console.log("ajax error")},complete:function(){t.find(".wd-loader-overlay").removeClass("wd-loading")}})},1e3))}),i.on("change",".wd-fbt-product select",function(){var t=s(this),d=t.parents(".wd-fbt-product").data("id"),d=t.parents(".wd-fbt").find(".wd-product[data-id="+d+"]").find(".product-image-link > img, .product-image-link > picture > img"),e=t.find("option:selected").data("image-src"),t=t.find("option:selected").data("image-srcset");d.attr("srcset")&&d.attr("srcset",t=t||e),d.attr("src",e)}),i.on("click",".wd-fbt-purchase-btn",function(t){t.preventDefault();var d,e,a=s(this);a.hasClass("wd-disabled")||(t=r(i),d=i.find("input[name=wd-fbt-main-product]").val(),e=i.find("input[name=wd-fbt-bundle-id]").val(),t&&void 0!==t[d]&&(clearTimeout(n),a.addClass("loading"),s.ajax({url:woodmart_settings.ajaxurl,data:{action:"woodmart_purchasable_fbt_products",products_id:t,main_product:d,bundle_id:e},method:"POST",success:function(t){var d=s(".woocommerce-notices-wrapper");d.empty(),t.notices&&0<t.notices.indexOf("error")?(d.append(t.notices),d=d.offset().top-woodmart_settings.ajax_scroll_offset,s("html, body").stop().animate({scrollTop:d},400)):void 0!==t.fragments&&(void 0!==s.fn.magnificPopup&&"widget"===woodmart_settings.add_to_cart_action&&s.magnificPopup.close(),a.addClass("added"),woodmartThemeModule.$body.trigger("added_to_cart",[t.fragments,t.cart_hash,""]))},error:function(){console.log("ajax error")},complete:function(){a.removeClass("loading")}})))})})},s(document).ready(function(){woodmartThemeModule.frequentlyBoughtTogether()})}(jQuery);